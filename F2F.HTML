<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ø´Ø§Ù…Ù„ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.17/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/canvg/3.0.9/umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/icojs@1.0.2/dist/ico.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
            color: #fff;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(15, 23, 42, 0.85);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.15);
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            color: white;
            font-size: 2.8em;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }

        .header p {
            color: rgba(255, 255, 255, 0.85);
            font-size: 1.2em;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .upload-section {
            background: rgba(30, 41, 59, 0.6);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px dashed rgba(100, 130, 255, 0.4);
            transition: all 0.3s ease;
            text-align: center;
        }

        .upload-section:hover {
            border-color: rgba(100, 200, 255, 0.7);
            transform: translateY(-2px);
            background: rgba(30, 41, 59, 0.7);
        }

        .upload-section.dragover {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.15);
        }

        .upload-icon {
            font-size: 4em;
            color: rgba(100, 200, 255, 0.8);
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(100, 200, 255, 0.4);
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(79, 172, 254, 0.4);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .upload-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.6);
        }

        .preview-section {
            display: none;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            border: 1px solid rgba(100, 130, 255, 0.2);
        }

        .preview-image {
            max-width: 100%;
            max-height: 320px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .file-info {
            color: white;
            background: rgba(15, 23, 42, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: right;
            border: 1px solid rgba(100, 130, 255, 0.2);
        }

        .conversion-section {
            display: none;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(100, 130, 255, 0.2);
        }

        .format-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .format-option {
            background: rgba(15, 23, 42, 0.6);
            border: 2px solid rgba(100, 130, 255, 0.3);
            border-radius: 10px;
            padding: 15px 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            color: rgba(200, 220, 255, 0.9);
            font-weight: bold;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .format-option:hover {
            border-color: #4facfe;
            background: rgba(79, 172, 254, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.2);
        }

        .format-option.selected {
            border-color: #4facfe;
            background: rgba(79, 172, 254, 0.3);
            color: white;
            box-shadow: 0 0 15px rgba(79, 172, 254, 0.3);
        }

        .format-icon {
            font-size: 1.8em;
        }

        .convert-btn {
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            color: white;
            padding: 16px 40px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .convert-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.6);
        }

        .convert-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .quality-control {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            border: 1px solid rgba(100, 130, 255, 0.2);
        }

        .quality-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: rgba(200, 220, 255, 0.9);
        }

        .quality-slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            background: rgba(100, 130, 255, 0.2);
            border-radius: 4px;
            outline: none;
        }

        .quality-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4facfe;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(79, 172, 254, 0.8);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(100, 130, 255, 0.2);
            border-radius: 4px;
            margin: 20px 0;
            display: none;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border-radius: 4px;
            width: 0%;
            transition: width 0.4s ease;
        }

        .download-section {
            display: none;
            text-align: center;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 15px;
            padding: 30px;
            border: 1px solid rgba(100, 130, 255, 0.2);
        }

        .download-btn {
            background: linear-gradient(45deg, #42e695, #3bb2b8);
            color: white;
            padding: 16px 45px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(66, 230, 149, 0.4);
        }

        .download-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(66, 230, 149, 0.6);
        }

        .reset-btn {
            background: rgba(100, 130, 255, 0.2);
            color: rgba(200, 220, 255, 0.9);
            padding: 12px 25px;
            border: 1px solid rgba(100, 130, 255, 0.3);
            border-radius: 50px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .reset-btn:hover {
            background: rgba(100, 130, 255, 0.3);
            color: white;
        }

        .nav-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 15px;
            padding: 10px;
            border: 1px solid rgba(100, 130, 255, 0.2);
        }

        .tab-btn {
            background: transparent;
            border: none;
            color: rgba(200, 220, 255, 0.9);
            padding: 16px 35px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 0 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tab-btn:hover {
            color: white;
            background: rgba(100, 130, 255, 0.1);
        }

        .tab-btn.active {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            color: white;
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
        
        .supported-formats {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            color: rgba(200, 220, 255, 0.9);
            text-align: center;
            border: 1px solid rgba(100, 130, 255, 0.2);
        }

        .loading {
            display: none;
            color: white;
            text-align: center;
            margin: 20px 0;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            display: none;
            background: rgba(244, 67, 54, 0.15);
            border: 1px solid rgba(244, 67, 54, 0.3);
            color: #ff6b6b;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
        }

        .text-preview {
            background: rgba(15, 23, 42, 0.7);
            color: rgba(200, 220, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            max-height: 250px;
            overflow-y: auto;
            margin-bottom: 20px;
            text-align: right;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            border: 1px solid rgba(100, 130, 255, 0.2);
        }

        .advanced-options {
            background: rgba(15, 23, 42, 0.7);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(100, 130, 255, 0.2);
        }

        .option-title {
            color: #4facfe;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .option-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .option-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .option-label {
            color: rgba(200, 220, 255, 0.9);
            font-weight: 500;
        }

        .option-input {
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid rgba(100, 130, 255, 0.3);
            background: rgba(30, 41, 59, 0.6);
            color: white;
            font-family: inherit;
        }

        .option-input:focus {
            outline: none;
            border-color: #4facfe;
        }

        .file-size-warning {
            color: #ffb74d;
            font-size: 0.9em;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
            
            .format-selector {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 10px;
            }
            
            .tab-btn {
                padding: 14px 20px;
                font-size: 0.95em;
            }
            
            .option-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”„ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ø´Ø§Ù…Ù„ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø©</h1>
            <p>Ø­ÙˆÙ„ ØµÙˆØ±Ùƒ ÙˆÙ…Ø³ØªÙ†Ø¯Ø§ØªÙƒ Ø¥Ù„Ù‰ Ø£ÙŠ ØªÙ†Ø³ÙŠÙ‚ ØªØ±ÙŠØ¯Ù‡ Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© Ù…Ø¹ Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</p>
        </div>

        <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„ØªÙ†Ù‚Ù„ -->
        <div class="nav-tabs">
            <button id="imagesTabBtn" class="tab-btn active">ğŸ–¼ï¸ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±</button>
            <button id="documentsTabBtn" class="tab-btn">ğŸ“„ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</button>
        </div>

        <!-- Ù…Ø­ØªÙˆÙ‰ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ± -->
        <div id="imagesTab" class="tab-content active">
            <div class="upload-section" id="uploadSection">
                <div class="upload-icon">ğŸ“¤</div>
                <p style="color: rgba(200, 220, 255, 0.9); margin-bottom: 20px; font-size: 1.1em;">Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø± (Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø£Ù‚ØµÙ‰: 10MB)</p>
                <input type="file" id="fileInput" class="file-input" accept="image/*">
                <button class="upload-btn" onclick="document.getElementById('fileInput').click()">
                    Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ±Ø©
                </button>
            </div>

            <div class="preview-section" id="previewSection">
                <img id="previewImage" class="preview-image" alt="Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø©">
                <div class="file-info" id="fileInfo"></div>
            </div>

            <div class="conversion-section" id="conversionSection">
                <h3 style="color: white; margin-bottom: 20px; text-align: center;">Ø§Ø®ØªØ± Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</h3>
                <div class="format-selector" id="formatSelector">
                    <div class="format-option" data-format="jpeg">
                        <span class="format-icon">ğŸ–¼ï¸</span>
                        JPEG
                    </div>
                    <div class="format-option" data-format="png">
                        <span class="format-icon">ğŸ–¼ï¸</span>
                        PNG
                    </div>
                    <div class="format-option" data-format="webp">
                        <span class="format-icon">ğŸ–¼ï¸</span>
                        WebP
                    </div>
                    <div class="format-option" data-format="bmp">
                        <span class="format-icon">ğŸ–¼ï¸</span>
                        BMP
                    </div>
                    <div class="format-option" data-format="gif">
                        <span class="format-icon">ğŸ–¼ï¸</span>
                        GIF
                    </div>
                    <div class="format-option" data-format="tiff">
                        <span class="format-icon">ğŸ–¼ï¸</span>
                        TIFF
                    </div>
                    <div class="format-option" data-format="ico">
                        <span class="format-icon">ğŸ–¼ï¸</span>
                        ICO
                    </div>
                    <div class="format-option" data-format="svg">
                        <span class="format-icon">ğŸ–¼ï¸</span>
                        SVG
                    </div>
                </div>
                
                <div class="advanced-options">
                    <h3 class="option-title">âš™ï¸ Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
                    <div class="quality-control">
                        <div class="quality-label">
                            <span>Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØ±Ø©:</span>
                            <span id="qualityValue">95%</span>
                        </div>
                        <input type="range" min="10" max="100" value="95" class="quality-slider" id="qualitySlider">
                        <div class="file-size-warning">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ù†Ø®ÙØ¶Ø© ØªÙ‚Ù„Ù„ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù</div>
                    </div>
                    
                    <div class="option-group">
                        <div class="option-item">
                            <label class="option-label">Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„ØµÙˆØ±Ø©:</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="number" id="widthInput" class="option-input" placeholder="Ø§Ù„Ø¹Ø±Ø¶">
                                <input type="number" id="heightInput" class="option-input" placeholder="Ø§Ù„Ø§Ø±ØªÙØ§Ø¹">
                            </div>
                        </div>
                        
                        <div class="option-item">
                            <label class="option-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶ØºØ·:</label>
                            <select id="compressionLevel" class="option-input">
                                <option value="high">Ø¹Ø§Ù„ÙŠØ© (Ø£Ù‚Ù„ Ø¬ÙˆØ¯Ø©)</option>
                                <option value="medium" selected>Ù…ØªÙˆØ³Ø·Ø©</option>
                                <option value="low">Ù…Ù†Ø®ÙØ¶Ø© (Ø£ÙØ¶Ù„ Ø¬ÙˆØ¯Ø©)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©...</p>
                </div>
                
                <div class="progress-bar" id="progressBar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                
                <button class="convert-btn" id="convertBtn" disabled>
                    <span>Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­ÙˆÙŠÙ„</span>
                    <span>âš¡</span>
                </button>
                
                <div class="error-message" id="errorMessage"></div>
            </div>

            <div class="download-section" id="downloadSection">
                <h3 style="color: white; margin-bottom: 20px; font-size: 1.5em;">ğŸ‰ ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</h3>
                <p style="color: rgba(200, 220, 255, 0.9); margin-bottom: 25px;">Ø§Ù„ØµÙˆØ±Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</p>
                <a class="download-btn" id="downloadBtn" download>
                    <span>ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø­ÙˆÙ„Ø©</span>
                    <span>â¬‡ï¸</span>
                </a>
                <br>
                <button class="reset-btn" id="resetImageBtn">ØªØ­ÙˆÙŠÙ„ ØµÙˆØ±Ø© Ø£Ø®Ø±Ù‰</button>
            </div>
        </div>

        <!-- Ù…Ø­ØªÙˆÙ‰ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª -->
        <div id="documentsTab" class="tab-content">
            <div class="upload-section" id="docUploadSection">
                <div class="upload-icon">ğŸ“„</div>
                <p style="color: rgba(200, 220, 255, 0.9); margin-bottom: 20px; font-size: 1.1em;">Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù†ØµÙŠ Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„Ø§Ø®ØªÙŠØ§Ø± (Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø£Ù‚ØµÙ‰: 5MB)</p>
                <input type="file" id="docFileInput" class="file-input" accept=".txt,.rtf,.csv,.json,.xml,.html,.md,.doc,.docx,.pdf,.sql">
                <button class="upload-btn" onclick="document.getElementById('docFileInput').click()">
                    Ø§Ø®ØªØ± Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù†ØµÙŠ
                </button>
            </div>

            <div class="preview-section" id="docPreviewSection">
                <div class="text-preview" id="textPreview"></div>
                <div class="file-info" id="docFileInfo"></div>
            </div>

            <div class="conversion-section" id="docConversionSection">
                <h3 style="color: white; margin-bottom: 20px; text-align: center;">Ø§Ø®ØªØ± Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</h3>
                <div class="format-selector" id="docFormatSelector">
                    <div class="format-option" data-format="txt">
                        <span class="format-icon">ğŸ“</span>
                        TXT
                    </div>
                    <div class="format-option" data-format="rtf">
                        <span class="format-icon">ğŸ“</span>
                        RTF
                    </div>
                    <div class="format-option" data-format="csv">
                        <span class="format-icon">ğŸ“Š</span>
                        CSV
                    </div>
                    <div class="format-option" data-format="json">
                        <span class="format-icon">ğŸ“Š</span>
                        JSON
                    </div>
                    <div class="format-option" data-format="xml">
                        <span class="format-icon">ğŸ“Š</span>
                        XML
                    </div>
                    <div class="format-option" data-format="html">
                        <span class="format-icon">ğŸŒ</span>
                        HTML
                    </div>
                    <div class="format-option" data-format="md">
                        <span class="format-icon">ğŸ“</span>
                        Markdown
                    </div>
                    <div class="format-option" data-format="sql">
                        <span class="format-icon">ğŸ’¾</span>
                        SQL
                    </div>
                    <div class="format-option" data-format="pdf">
                        <span class="format-icon">ğŸ“„</span>
                        PDF
                    </div>
                    <div class="format-option" data-format="docx">
                        <span class="format-icon">ğŸ“„</span>
                        DOCX
                    </div>
                </div>
                
                <div class="advanced-options">
                    <h3 class="option-title">âš™ï¸ Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
                    <div class="option-group">
                        <div class="option-item">
                            <label class="option-label">ØªØ±Ù…ÙŠØ² Ø§Ù„Ù†Øµ:</label>
                            <select id="encodingSelect" class="option-input">
                                <option value="UTF-8">UTF-8 (Ù…Ø³ØªØ­Ø³Ù†)</option>
                                <option value="ISO-8859-6">ISO-8859-6 (Ø¹Ø±Ø¨ÙŠ)</option>
                                <option value="Windows-1256">Windows-1256 (Ø¹Ø±Ø¨ÙŠ)</option>
                            </select>
                        </div>
                        
                        <div class="option-item">
                            <label class="option-label">Ù†Ù…Ø· Markdown:</label>
                            <select id="markdownStyle" class="option-input">
                                <option value="basic">Ø£Ø³Ø§Ø³ÙŠ</option>
                                <option value="github">GitHub</option>
                                <option value="extended">Ù…ÙˆØ³Ø¹</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="loading" id="docLoading">
                    <div class="spinner"></div>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ù„Ù...</p>
                </div>
                
                <div class="progress-bar" id="docProgressBar">
                    <div class="progress-fill" id="docProgressFill"></div>
                </div>
                
                <button class="convert-btn" id="docConvertBtn" disabled>
                    <span>Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­ÙˆÙŠÙ„</span>
                    <span>âš¡</span>
                </button>
                
                <div class="error-message" id="docErrorMessage"></div>
            </div>

            <div class="download-section" id="docDownloadSection">
                <h3 style="color: white; margin-bottom: 20px; font-size: 1.5em;">ğŸ‰ ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!</h3>
                <p style="color: rgba(200, 220, 255, 0.9); margin-bottom: 25px;">Ø§Ù„Ù…Ù„Ù Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</p>
                <a class="download-btn" id="docDownloadBtn" download>
                    <span>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­ÙˆÙ„</span>
                    <span>â¬‡ï¸</span>
                </a>
                <br>
                <button class="reset-btn" id="resetDocBtn">ØªØ­ÙˆÙŠÙ„ Ù…Ù„Ù Ø¢Ø®Ø±</button>
            </div>
        </div>

        <div class="supported-formats">
            <h4>ğŸ¯ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©:</h4>
            <p><strong>Ø§Ù„ØµÙˆØ±:</strong> JPEG, PNG, WebP, BMP, GIF, TIFF, ICO, SVG</p>
            <p><strong>Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª:</strong> TXT, RTF, CSV, JSON, XML, HTML, Markdown, SQL, PDF, DOCX</p>
            <p style="margin-top: 15px; color: #4facfe; font-weight: 500;">Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© ØªØ¶Ù… Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¬ÙˆØ¯Ø© ÙˆØ®ØµØ§Ø¦Øµ Ø§Ù„ØªØ­ÙˆÙŠÙ„</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
            let selectedFile = null;
            let selectedFormat = null;
            let selectedDocFile = null;
            let selectedDocFormat = null;
            let currentTab = 'images';
            let imageQuality = 95;
            let compressionLevel = 'medium';
            let markdownStyle = 'basic';

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± - Ø§Ù„ØµÙˆØ±
            const fileInput = document.getElementById('fileInput');
            const uploadSection = document.getElementById('uploadSection');
            const previewSection = document.getElementById('previewSection');
            const conversionSection = document.getElementById('conversionSection');
            const downloadSection = document.getElementById('downloadSection');
            const previewImage = document.getElementById('previewImage');
            const fileInfo = document.getElementById('fileInfo');
            const formatSelector = document.getElementById('formatSelector');
            const convertBtn = document.getElementById('convertBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const loading = document.getElementById('loading');
            const progressBar = document.getElementById('progressBar');
            const progressFill = document.getElementById('progressFill');
            const errorMessage = document.getElementById('errorMessage');
            const resetImageBtn = document.getElementById('resetImageBtn');
            const qualitySlider = document.getElementById('qualitySlider');
            const qualityValue = document.getElementById('qualityValue');
            const widthInput = document.getElementById('widthInput');
            const heightInput = document.getElementById('heightInput');
            const compressionSelect = document.getElementById('compressionLevel');

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± - Ø§Ù„Ù†ØµÙˆØµ
            const docFileInput = document.getElementById('docFileInput');
            const docUploadSection = document.getElementById('docUploadSection');
            const docPreviewSection = document.getElementById('docPreviewSection');
            const docConversionSection = document.getElementById('docConversionSection');
            const docDownloadSection = document.getElementById('docDownloadSection');
            const textPreview = document.getElementById('textPreview');
            const docFileInfo = document.getElementById('docFileInfo');
            const docFormatSelector = document.getElementById('docFormatSelector');
            const docConvertBtn = document.getElementById('docConvertBtn');
            const docDownloadBtn = document.getElementById('docDownloadBtn');
            const docLoading = document.getElementById('docLoading');
            const docProgressBar = document.getElementById('docProgressBar');
            const docProgressFill = document.getElementById('docProgressFill');
            const docErrorMessage = document.getElementById('docErrorMessage');
            const resetDocBtn = document.getElementById('resetDocBtn');
            const encodingSelect = document.getElementById('encodingSelect');
            const markdownStyleSelect = document.getElementById('markdownStyle');

            // Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            const imagesTabBtn = document.getElementById('imagesTabBtn');
            const documentsTabBtn = document.getElementById('documentsTabBtn');
            const imagesTab = document.getElementById('imagesTab');
            const documentsTab = document.getElementById('documentsTab');

            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            imagesTabBtn.addEventListener('click', () => switchTab('images'));
            documentsTabBtn.addEventListener('click', () => switchTab('documents'));

            // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            function switchTab(tabName) {
                currentTab = tabName;
                
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                document.getElementById(tabName + 'Tab').classList.add('active');
                
                if (tabName === 'images') {
                    imagesTabBtn.classList.add('active');
                } else {
                    documentsTabBtn.classList.add('active');
                }
            }

            // Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„ØµÙˆØ±
            fileInput.addEventListener('change', handleFileSelect);
            uploadSection.addEventListener('dragover', handleDragOver);
            uploadSection.addEventListener('dragleave', handleDragLeave);
            uploadSection.addEventListener('drop', handleFileDrop);
            formatSelector.addEventListener('click', handleFormatSelect);
            convertBtn.addEventListener('click', convertImage);
            resetImageBtn.addEventListener('click', resetConverter);
            qualitySlider.addEventListener('input', updateQualityValue);
            compressionSelect.addEventListener('change', updateCompressionLevel);

            // Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ù†ØµÙˆØµ
            docFileInput.addEventListener('change', handleDocFileSelect);
            docUploadSection.addEventListener('dragover', handleDocDragOver);
            docUploadSection.addEventListener('dragleave', handleDocDragLeave);
            docUploadSection.addEventListener('drop', handleDocFileDrop);
            docFormatSelector.addEventListener('click', handleDocFormatSelect);
            docConvertBtn.addEventListener('click', convertDocument);
            resetDocBtn.addEventListener('click', resetDocConverter);
            markdownStyleSelect.addEventListener('change', updateMarkdownStyle);

            // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØµÙˆØ±
            function handleFileSelect(event) {
                const file = event.target.files[0];
                if (file) {
                    if (file.size > 10 * 1024 * 1024) {
                        showError('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§! Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 10MB');
                        return;
                    }
                    if (!file.type.startsWith('image/')) {
                        showError('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ØµÙˆØ±Ø© ØµØ­ÙŠØ­');
                        return;
                    }
                    processFile(file);
                }
            }

            function handleDragOver(event) {
                event.preventDefault();
                uploadSection.classList.add('dragover');
            }

            function handleDragLeave(event) {
                event.preventDefault();
                uploadSection.classList.remove('dragover');
            }

            function handleFileDrop(event) {
                event.preventDefault();
                uploadSection.classList.remove('dragover');
                
                const files = event.dataTransfer.files;
                if (files.length > 0) {
                    const file = files[0];
                    if (file.size > 10 * 1024 * 1024) {
                        showError('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§! Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 10MB');
                        return;
                    }
                    if (file.type.startsWith('image/')) {
                        processFile(file);
                    } else {
                        showError('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ØµÙˆØ±Ø© ØµØ­ÙŠØ­');
                    }
                }
            }

            function processFile(file) {
                selectedFile = file;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    previewSection.style.display = 'block';
                    
                    const fileSize = (file.size / 1024 / 1024).toFixed(2);
                    const fileType = file.type.split('/')[1].toUpperCase();
                    
                    fileInfo.innerHTML = `
                        <strong>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</strong> ${file.name}<br>
                        <strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${fileType}<br>
                        <strong>Ø§Ù„Ø­Ø¬Ù…:</strong> ${fileSize} Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª<br>
                        <strong>Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯:</strong> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©...
                    `;
                    
                    previewImage.onload = function() {
                        fileInfo.innerHTML = `
                            <strong>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</strong> ${file.name}<br>
                            <strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${fileType}<br>
                            <strong>Ø§Ù„Ø­Ø¬Ù…:</strong> ${fileSize} Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª<br>
                            <strong>Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯:</strong> ${this.width} Ã— ${this.height} Ø¨ÙƒØ³Ù„
                        `;
                        widthInput.value = this.width;
                        heightInput.value = this.height;
                    };
                    
                    conversionSection.style.display = 'block';
                    downloadSection.style.display = 'none';
                    hideError();
                };
                reader.readAsDataURL(file);
            }

            function handleFormatSelect(event) {
                if (event.target.classList.contains('format-option')) {
                    document.querySelectorAll('#formatSelector .format-option').forEach(option => {
                        option.classList.remove('selected');
                    });
                    
                    event.target.classList.add('selected');
                    selectedFormat = event.target.dataset.format;
                    convertBtn.disabled = false;
                    
                    // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø© Ø­Ø³Ø¨ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚
                    if (['jpeg', 'webp'].includes(selectedFormat)) {
                        document.querySelector('.quality-control').style.display = 'block';
                    } else {
                        document.querySelector('.quality-control').style.display = 'none';
                    }
                }
            }

            function updateQualityValue() {
                imageQuality = qualitySlider.value;
                qualityValue.textContent = imageQuality + '%';
            }

            function updateCompressionLevel() {
                compressionLevel = compressionSelect.value;
            }

            function updateMarkdownStyle() {
                markdownStyle = markdownStyleSelect.value;
            }

            function convertImage() {
                if (!selectedFile || !selectedFormat) return;
                
                showLoading();
                hideError();
                
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = function() {
                    let targetWidth = parseInt(widthInput.value) || img.width;
                    let targetHeight = parseInt(heightInput.value) || img.height;
                    
                    canvas.width = targetWidth;
                    canvas.height = targetHeight;
                    ctx.drawImage(img, 0, 0, targetWidth, targetHeight);
                    
                    let mimeType;
                    let quality = imageQuality / 100;
                    
                    // Ø¶Ø¨Ø· Ø§Ù„Ø¬ÙˆØ¯Ø© Ø­Ø³Ø¨ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¶ØºØ· Ø§Ù„Ù…Ø®ØªØ§Ø±
                    if (compressionLevel === 'high') quality = Math.max(0.3, quality * 0.7);
                    else if (compressionLevel === 'low') quality = Math.min(1.0, quality * 1.2);
                    
                    switch(selectedFormat) {
                        case 'jpeg':
                            mimeType = 'image/jpeg';
                            break;
                        case 'png':
                            mimeType = 'image/png';
                            quality = undefined; // Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¶ØºØ· ÙÙŠ PNG
                            break;
                        case 'webp':
                            mimeType = 'image/webp';
                            break;
                        case 'bmp':
                            mimeType = 'image/bmp';
                            break;
                        case 'gif':
                            mimeType = 'image/gif';
                            break;
                        case 'tiff':
                            mimeType = 'image/tiff';
                            break;
                        case 'ico':
                            // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ICO Ø¨Ø£Ø­Ø¬Ø§Ù… Ù…ØªØ¹Ø¯Ø¯Ø©
                            convertToIco(img);
                            return;
                        case 'svg':
                            // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ SVG Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… canvg
                            convertToSvg(canvas);
                            return;
                        default:
                            mimeType = 'image/png';
                    }
                    
                    simulateProgress(() => {
                        try {
                            canvas.toBlob(function(blob) {
                                if (blob) {
                                    finishConversion(blob, selectedFormat);
                                } else {
                                    throw new Error('ÙØ´Ù„ ÙÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©');
                                }
                            }, mimeType, quality);
                        } catch (error) {
                            hideLoading();
                            showError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©: ' + error.message);
                        }
                    });
                };
                
                img.onerror = function() {
                    hideLoading();
                    showError('ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØµÙˆØ±Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù.');
                };
                
                img.src = URL.createObjectURL(selectedFile);
            }

            function convertToIco(img) {
                const sizes = [16, 32, 48, 64];
                const canvases = sizes.map(size => {
                    const canvas = document.createElement('canvas');
                    canvas.width = size;
                    canvas.height = size;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, size, size);
                    return canvas;
                });
                
                simulateProgress(() => {
                    try {
                        ICO.encode(canvases.map(canvas => {
                            return {
                                width: canvas.width,
                                height: canvas.height,
                                context: canvas.getContext('2d')
                            };
                        })).then(blob => {
                            finishConversion(blob, 'ico');
                        }).catch(error => {
                            hideLoading();
                            showError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ ICO: ' + error.message);
                        });
                    } catch (error) {
                        hideLoading();
                        showError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©: ' + error.message);
                    }
                });
            }

            function convertToSvg(canvas) {
                simulateProgress(() => {
                    try {
                        const svgData = createSVGFromCanvas(canvas);
                        const blob = new Blob([svgData], { type: 'image/svg+xml' });
                        finishConversion(blob, 'svg');
                    } catch (error) {
                        hideLoading();
                        showError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ SVG: ' + error.message);
                    }
                });
            }

            function createSVGFromCanvas(canvas) {
                const ctx = canvas.getContext('2d');
                const dataURL = canvas.toDataURL('image/png');
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… canvg Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ SVG Ù…ØªØ¬Ù‡ÙŠ
                const svg = canvg.Canvg.fromString(ctx, `<svg xmlns="http://www.w3.org/2000/svg" width="${canvas.width}" height="${canvas.height}">
                    <image href="${dataURL}" width="${canvas.width}" height="${canvas.height}"/>
                </svg>`);
                
                return svg.toSVG();
            }

            function finishConversion(blob, format) {
                const url = URL.createObjectURL(blob);
                const fileName = selectedFile.name.replace(/\.[^/.]+$/, '') + '.' + format;
                
                downloadBtn.href = url;
                downloadBtn.download = fileName;
                
                hideLoading();
                conversionSection.style.display = 'none';
                downloadSection.style.display = 'block';
            }

            // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù†ØµÙˆØµ
            function handleDocFileSelect(event) {
                const file = event.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        showDocError('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§! Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 5MB');
                        return;
                    }
                    processDocFile(file);
                }
            }

            function handleDocDragOver(event) {
                event.preventDefault();
                docUploadSection.classList.add('dragover');
            }

            function handleDocDragLeave(event) {
                event.preventDefault();
                docUploadSection.classList.remove('dragover');
            }

            function handleDocFileDrop(event) {
                event.preventDefault();
                docUploadSection.classList.remove('dragover');
                
                const files = event.dataTransfer.files;
                if (files.length > 0) {
                    const file = files[0];
                    if (file.size > 5 * 1024 * 1024) {
                        showDocError('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ù‹Ø§! Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 5MB');
                        return;
                    }
                    processDocFile(file);
                }
            }

            function processDocFile(file) {
                selectedDocFile = file;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    let content = e.target.result;
                    
                    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
                    if (file.name.endsWith('.json')) {
                        try {
                            content = JSON.stringify(JSON.parse(content), null, 2);
                        } catch (err) {
                            content = e.target.result;
                        }
                    }
                    
                    // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù…Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø·ÙˆÙ„
                    const preview = content.length > 1000 ? content.substring(0, 1000) + '...' : content;
                    textPreview.textContent = preview;
                    docPreviewSection.style.display = 'block';
                    
                    const fileSize = (file.size / 1024).toFixed(2);
                    const fileExt = file.name.split('.').pop().toUpperCase();
                    
                    docFileInfo.innerHTML = `
                        <strong>Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</strong> ${file.name}<br>
                        <strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${fileExt}<br>
                        <strong>Ø§Ù„Ø­Ø¬Ù…:</strong> ${fileSize} ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª
                    `;
                    
                    docConversionSection.style.display = 'block';
                    docDownloadSection.style.display = 'none';
                    hideDocError();
                };
                
                reader.onerror = function() {
                    showDocError('ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù…Ù„Ù.');
                };
                
                reader.readAsText(file, 'UTF-8');
            }

            function handleDocFormatSelect(event) {
                if (event.target.classList.contains('format-option')) {
                    document.querySelectorAll('#docFormatSelector .format-option').forEach(option => {
                        option.classList.remove('selected');
                    });
                    
                    event.target.classList.add('selected');
                    selectedDocFormat = event.target.dataset.format;
                    docConvertBtn.disabled = false;
                }
            }

            function convertDocument() {
                if (!selectedDocFile || !selectedDocFormat) return;
                
                showDocLoading();
                hideDocError();
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    let content = e.target.result;
                    let convertedContent = '';
                    let mimeType = 'text/plain';
                    let fileName = selectedDocFile.name.replace(/\.[^/.]+$/, '');
                    
                    try {
                        // ØªØ­ÙˆÙŠÙ„ Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
                        switch(selectedDocFormat) {
                            case 'txt':
                                convertedContent = stripFormatting(content);
                                mimeType = 'text/plain';
                                break;
                            case 'rtf':
                                convertedContent = convertToRTF(content);
                                mimeType = 'application/rtf';
                                break;
                            case 'csv':
                                convertedContent = convertToCSV(content);
                                mimeType = 'text/csv';
                                break;
                            case 'json':
                                convertedContent = convertToJSON(content);
                                mimeType = 'application/json';
                                break;
                            case 'xml':
                                convertedContent = convertToXML(content);
                                mimeType = 'application/xml';
                                break;
                            case 'html':
                                convertedContent = convertToHTML(content);
                                mimeType = 'text/html';
                                break;
                            case 'md':
                                convertedContent = convertToMarkdown(content);
                                mimeType = 'text/markdown';
                                break;
                            case 'sql':
                                convertedContent = convertToSQL(content);
                                mimeType = 'application/sql';
                                break;
                            case 'pdf':
                                convertToPDF(content, fileName);
                                return;
                            case 'docx':
                                convertToDocx(content, fileName);
                                return;
                            default:
                                convertedContent = content;
                        }
                        
                        simulateDocProgress(() => {
                            const blob = new Blob([convertedContent], { type: mimeType + ';charset=utf-8' });
                            const url = URL.createObjectURL(blob);
                            
                            docDownloadBtn.href = url;
                            docDownloadBtn.download = fileName + '.' + selectedDocFormat;
                            
                            hideDocLoading();
                            docConversionSection.style.display = 'none';
                            docDownloadSection.style.display = 'block';
                        });
                        
                    } catch (error) {
                        hideDocLoading();
                        showDocError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ù„Ù: ' + error.message);
                    }
                };
                
                reader.onerror = function() {
                    hideDocLoading();
                    showDocError('ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù.');
                };
                
                reader.readAsText(selectedDocFile, 'UTF-8');
            }

            // ÙˆØ¸Ø§Ø¦Ù ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ
            function stripFormatting(content) {
                // Ø¥Ø²Ø§Ù„Ø© Ø¹Ù„Ø§Ù…Ø§Øª HTML ÙˆØ§Ù„ØªÙ†Ø³ÙŠÙ‚
                return content.replace(/<[^>]*>/g, '').replace(/&[^;]+;/g, ' ').trim();
            }

            function convertToRTF(content) {
                const cleanContent = stripFormatting(content);
                return `{\\rtf1\\ansi\\deff0 {\\fonttbl {\\f0 Times New Roman;}}\\f0\\fs24 ${cleanContent.replace(/\n/g, '\\par ')}}`;
            }

            function convertToCSV(content) {
                const lines = content.split('\n').filter(line => line.trim());
                if (lines.length === 0) return 'Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª,Ø§Ù„Ù‚ÙŠÙ…Ø©\n"Ù†Øµ","' + content.replace(/"/g, '""') + '"';
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ CSV
                let csv = 'Ø§Ù„Ø³Ø·Ø±,Ø§Ù„Ù…Ø­ØªÙˆÙ‰\n';
                lines.forEach((line, index) => {
                    csv += `"${index + 1}","${line.replace(/"/g, '""')}"\n`;
                });
                return csv;
            }

            function convertToJSON(content) {
                try {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø­ØªÙˆÙ‰ JSON ØµØ§Ù„Ø­ØŒ Ø£Ø¹Ø¯ ØªÙ†Ø³ÙŠÙ‚Ù‡
                    const parsed = JSON.parse(content);
                    return JSON.stringify(parsed, null, 2);
                } catch (e) {
                    // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† JSONØŒ Ø­ÙˆÙ„Ù‡ Ø¥Ù„Ù‰ ÙƒØ§Ø¦Ù† JSON
                    const lines = content.split('\n').filter(line => line.trim());
                    const jsonData = {
                        type: "text_document",
                        created: new Date().toISOString(),
                        content: lines.length > 1 ? lines : content,
                        metadata: {
                            original_file: selectedDocFile.name,
                            lines_count: lines.length,
                            character_count: content.length
                        }
                    };
                    return JSON.stringify(jsonData, null, 2);
                }
            }

            function convertToXML(content) {
                const cleanContent = content.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
                const lines = cleanContent.split('\n').filter(line => line.trim());
                
                let xml = '<?xml version="1.0" encoding="UTF-8"?>\n<document>\n';
                xml += `  <metadata>\n    <filename>${selectedDocFile.name}</filename>\n    <created>${new Date().toISOString()}</created>\n  </metadata>\n`;
                xml += '  <content>\n';
                
                if (lines.length > 1) {
                    lines.forEach((line, index) => {
                        xml += `    <line number="${index + 1}">${line.trim()}</line>\n`;
                    });
                } else {
                    xml += `    <text>${cleanContent}</text>\n`;
                }
                
                xml += '  </content>\n</document>';
                return xml;
            }

            function convertToHTML(content) {
                const cleanContent = content.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
                const lines = cleanContent.split('\n');
                
                let html = `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${selectedDocFile.name}</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            line-height: 1.8; 
            margin: 40px; 
            max-width: 800px;
            margin: auto;
            padding: 30px;
            background: #f8f9fa;
            color: #212529;
        }
        .header { 
            border-bottom: 2px solid #4facfe; 
            padding-bottom: 20px; 
            margin-bottom: 30px; 
            text-align: center;
        }
        .content { 
            white-space: pre-wrap;
            font-size: 1.1em;
            line-height: 1.8;
        }
        p {
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ù„Ù: ${selectedDocFile.name}</h1>
        <p>ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙÙŠ: ${new Date().toLocaleDateString('ar-EG')}</p>
    </div>
    <div class="content">`;
                
                lines.forEach(line => {
                    html += line.trim() ? `<p>${line}</p>\n` : '<br>\n';
                });
                
                html += '    </div>\n</body>\n</html>';
                return html;
            }

            function convertToMarkdown(content) {
                const lines = content.split('\n');
                let markdown = `# ${selectedDocFile.name}\n\n`;
                markdown += `> ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„ ÙÙŠ: ${new Date().toLocaleDateString('ar-EG')}\n\n`;
                markdown += '---\n\n';
                
                let inList = false;
                lines.forEach((line, index) => {
                    const trimmedLine = line.trim();
                    
                    if (trimmedLine.length === 0) {
                        if (inList) {
                            markdown += '\n';
                            inList = false;
                        } else {
                            markdown += '\n';
                        }
                    } else if (trimmedLine.match(/^[\d\u0660-\u0669]+[\.\-\)]/)) {
                        // Ù‚Ø§Ø¦Ù…Ø© Ù…Ø±Ù‚Ù…Ø©
                        if (!inList) markdown += '\n';
                        markdown += `1. ${trimmedLine.replace(/^[\d\u0660-\u0669]+[\.\-\)]/, '').trim()}\n`;
                        inList = true;
                    } else if (trimmedLine.match(/^[\*\-\+]/)) {
                        // Ù‚Ø§Ø¦Ù…Ø© Ù†Ù‚Ø·ÙŠØ©
                        if (!inList) markdown += '\n';
                        markdown += `* ${trimmedLine.substring(1).trim()}\n`;
                        inList = true;
                    } else if (trimmedLine.match(/^#{1,6}\s/)) {
                        // Ø¹Ù†Ø§ÙˆÙŠÙ†
                        markdown += `${trimmedLine}\n\n`;
                        inList = false;
                    } else if (trimmedLine.match(/^(\*{1,3}|_{1,3})(.*?)\1$/)) {
                        // Ù†Øµ ØºØ§Ù…Ù‚ Ø£Ùˆ Ù…Ø§Ø¦Ù„
                        markdown += `${trimmedLine}\n\n`;
                        inList = false;
                    } else {
                        // Ù†Øµ Ø¹Ø§Ø¯ÙŠ
                        markdown += `${trimmedLine}\n`;
                        inList = false;
                    }
                });
                
                // ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ù…Ø®ØªØ§Ø±
                if (markdownStyle === 'github') {
                    markdown = markdown.replace(/\n{3,}/g, '\n\n');
                } else if (markdownStyle === 'extended') {
                    markdown = markdown.replace(/^(.+)$/gm, (match) => {
                        if (!match.startsWith('#') && !match.startsWith('>') && !match.startsWith('-') && !match.startsWith('1.')) {
                            return `> ${match}`;
                        }
                        return match;
                    });
                }
                
                return markdown;
            }

            function convertToSQL(content) {
                const lines = content.split('\n').filter(line => line.trim());
                let sql = `-- ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ù…Ù†: ${selectedDocFile.name}\n`;
                sql += `-- Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toISOString()}\n\n`;
                
                sql += `CREATE TABLE document_content (\n`;
                sql += `    id INT PRIMARY KEY AUTO_INCREMENT,\n`;
                sql += `    line_number INT,\n`;
                sql += `    content TEXT,\n`;
                sql += `    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n`;
                sql += `);\n\n`;
                
                lines.forEach((line, index) => {
                    const escapedContent = line.replace(/'/g, "''").replace(/\\/g, '\\\\');
                    sql += `INSERT INTO document_content (line_number, content) VALUES (${index + 1}, '${escapedContent}');\n`;
                });
                
                sql += `\n-- Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰\nSELECT * FROM document_content ORDER BY line_number;`;
                return sql;
            }

            function convertToPDF(content, fileName) {
                simulateDocProgress(() => {
                    try {
                        // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© pdf-lib Ù„Ø¥Ù†Ø´Ø§Ø¡ PDF
                        const { PDFDocument, StandardFonts, rgb } = PDFLib;
                        
                        PDFDocument.create().then(doc => {
                            const page = doc.addPage();
                            const { width, height } = page.getSize();
                            const fontSize = 12;
                            const margin = 50;
                            
                            page.drawText(content, {
                                x: margin,
                                y: height - margin - fontSize,
                                size: fontSize,
                                font: StandardFonts.Helvetica,
                                color: rgb(0, 0, 0),
                                maxWidth: width - margin * 2,
                                lineHeight: fontSize * 1.5
                            });
                            
                            doc.save().then(pdfBytes => {
                                const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                                const url = URL.createObjectURL(blob);
                                
                                docDownloadBtn.href = url;
                                docDownloadBtn.download = fileName + '.pdf';
                                
                                hideDocLoading();
                                docConversionSection.style.display = 'none';
                                docDownloadSection.style.display = 'block';
                            });
                        }).catch(error => {
                            hideDocLoading();
                            showDocError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ PDF: ' + error.message);
                        });
                    } catch (error) {
                        hideDocLoading();
                        showDocError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ PDF: ' + error.message);
                    }
                });
            }

            function convertToDocx(content, fileName) {
                simulateDocProgress(() => {
                    try {
                        // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© mammoth Ù„Ø¥Ù†Ø´Ø§Ø¡ DOCX
                        const result = mammoth.convertToHtml({ text: content });
                        result.then(function(res) {
                            const html = res.value;
                            
                            // ÙÙŠ Ø§Ù„ÙˆØ§Ù‚Ø¹ØŒ mammoth ÙŠØ­ÙˆÙ„ Ø¥Ù„Ù‰ HTML ÙÙ‚Ø·ØŒ Ù„ÙƒÙ†Ù†Ø§ Ù†Ø³ØªØ·ÙŠØ¹ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙƒØ£Ø³Ø§Ø³ Ù„Ø¥Ù†Ø´Ø§Ø¡ DOCX
                            // ÙÙŠ Ø¨ÙŠØ¦Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ù…ÙƒØªØ¨Ø© Ù…Ø«Ù„ docx.js
                            const blob = new Blob([content], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
                            const url = URL.createObjectURL(blob);
                            
                            docDownloadBtn.href = url;
                            docDownloadBtn.download = fileName + '.docx';
                            
                            hideDocLoading();
                            docConversionSection.style.display = 'none';
                            docDownloadSection.style.display = 'block';
                        });
                    } catch (error) {
                        hideDocLoading();
                        showDocError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ DOCX: ' + error.message);
                    }
                });
            }

            // ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø©
            function simulateProgress(callback) {
                progressBar.style.display = 'block';
                let progress = 0;
                
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress > 100) {
                        progress = 100;
                        clearInterval(interval);
                        setTimeout(callback, 300);
                    }
                    progressFill.style.width = progress + '%';
                }, 100);
            }

            function simulateDocProgress(callback) {
                docProgressBar.style.display = 'block';
                let progress = 0;
                
                const interval = setInterval(() => {
                    progress += Math.random() * 20;
                    if (progress > 100) {
                        progress = 100;
                        clearInterval(interval);
                        setTimeout(callback, 200);
                    }
                    docProgressFill.style.width = progress + '%';
                }, 80);
            }

            function showLoading() {
                loading.style.display = 'block';
                convertBtn.disabled = true;
            }

            function hideLoading() {
                loading.style.display = 'none';
                progressBar.style.display = 'none';
                progressFill.style.width = '0%';
                convertBtn.disabled = false;
            }

            function showDocLoading() {
                docLoading.style.display = 'block';
                docConvertBtn.disabled = true;
            }

            function hideDocLoading() {
                docLoading.style.display = 'none';
                docProgressBar.style.display = 'none';
                docProgressFill.style.width = '0%';
                docConvertBtn.disabled = false;
            }

            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
            }

            function hideError() {
                errorMessage.style.display = 'none';
            }

            function showDocError(message) {
                docErrorMessage.textContent = message;
                docErrorMessage.style.display = 'block';
            }

            function hideDocError() {
                docErrorMessage.style.display = 'none';
            }

            function resetConverter() {
                selectedFile = null;
                selectedFormat = null;
                
                previewSection.style.display = 'none';
                conversionSection.style.display = 'none';
                downloadSection.style.display = 'none';
                
                document.querySelectorAll('#formatSelector .format-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                convertBtn.disabled = true;
                fileInput.value = '';
                hideError();
                hideLoading();
            }

            function resetDocConverter() {
                selectedDocFile = null;
                selectedDocFormat = null;
                
                docPreviewSection.style.display = 'none';
                docConversionSection.style.display = 'none';
                docDownloadSection.style.display = 'none';
                
                document.querySelectorAll('#docFormatSelector .format-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                docConvertBtn.disabled = true;
                docFileInput.value = '';
                hideDocError();
                hideDocLoading();
            }
        });
    </script>
</body>
</html>